{% extends "stemp/base_side.html" %}

{% load staticfiles %}

{% block body-class %}u-vh--100{% endblock %}

{% block left_side %}

<div class="cell"><h1>{{labels.index}}</h1></div>
<ul class="wizard wizard-circular" role="steps" aria-label="Steps">
  <li class="current"><span class="show-for-sr">{{labels.index_tip}}</span> 1</li>
  <li>2</li>
  <li>3</li>
  <li>4</li>
</ul>

<div class="scen-create__description">
  <div class="scen-create__icon"><img src="{% static 'stemp/img/icons_custom/Enavi_Viertel.svg' %}"></div>
  <h2 class="scen-create__header">{{labels.title}}</h2>
  <p class="scen-create__text show-for-large">{{labels.text}}</p>
</div>

{% endblock %}}

{% block right_side %}

<div class="cell large-8 large-cell-block-y">
  <div class="grid-y large-grid-frame">
    <main class="cell large-auto large-cell-block-y main-content-wrap">

      <div class="cell scen-create__form u-text--center">
        <h3>{{demand_name|default:"Neues Viertel"}}</h3>
        <div class="icon-load">
          <a data-open="load_modal">
            <img src="{% static 'stemp/img/icons_custom/Enavi_Upload_ungültig.svg' %}" alt="Gespeichertes Viertel laden" title="Gespeichertes Szenario laden">
          </a>
        </div>
      </div>

      <form class="grid-x" method="post" id="district">
        {% csrf_token %}
        <input type="hidden" name="district_name" id="district_name" value="">
        <input type="hidden" name="district_status" id="district_status" value="{{district_status}}">

        <div class="cell large-10 large-offset-1 card-medium">
          <div class="grid-container">
            <div class="grid-x grid-padding-x small-up-1 medium-up-2">
              {% for field in district_form %}
                {{field}}
              {% endfor %}
            </div>
          </div>
        </div>

      </form>
    </main>
    <!-- STEPS TASKS END -->

    {% url 'stemp:demand_selection' as back_url%}

    {% if district_status == 'unchanged' %}
      {% include 'includes/button_section.html' with back_url=back_url function="$('#district').submit();" %}
    {% else %}
      {% include 'includes/button_section.html' with back_url=back_url modal="true" done_id="district_modal" function="$('#district').submit();" %}
    {% endif %}
  </div>
</div>

<div class="reveal" id="district_modal" data-reveal>
  {% if district_status == 'changed' %}
    Das Viertel wurde geändert - was soll passieren?<br>
    <input type="button" onclick="district_save()" class="btn btn-cta btn-submit" value="Änderungen speichern"><br>
    Viertel unter neuem Namen speichern:
  {% else %}
    Wie soll das neue Viertel heißen?
  {% endif %}
  <input type="text" name="district_name" id="district_name_modal">
  <input type="button" onclick="district_submit()" class="btn btn-cta btn-submit" value="Neues Viertel anlegen">
</div>

<!-- LOAD MODAL START -->
<div class="reveal" id="load_modal" data-reveal>
  <form method="post">
    {% csrf_token %}
    {{district_load_form}}
    <input type="submit" name="load_district" value="Laden">
  </form>
</div>
<!-- LOAD MODAL END -->

{% endblock %}

{% block scripts %}
<!--<script src="{% static 'jquery.js' %}"></script>-->
<script language="JavaScript">
  function district_submit() {
    $("#district_name").val($("#district_name_modal").val());
    $("#district").submit();
  }
  function district_save() {
    $("#district").submit();
  }
  function district_changed() {
    $("#district_status").val("changed");
  }
</script>
{% endblock %}